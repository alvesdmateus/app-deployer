basePath: /api/v1
definitions:
  analyzer.AnalysisResult:
    properties:
      build_command:
        type: string
      build_tool:
        $ref: '#/definitions/analyzer.BuildTool'
      confidence:
        type: number
      dependencies:
        additionalProperties:
          type: string
        type: object
      dev_dependencies:
        additionalProperties:
          type: string
        type: object
      files:
        items:
          type: string
        type: array
      framework:
        $ref: '#/definitions/analyzer.Framework'
      has_dockerfile:
        type: boolean
      language:
        $ref: '#/definitions/analyzer.Language'
      port:
        type: integer
      runtime:
        type: string
      start_command:
        type: string
    type: object
  analyzer.BuildTool:
    enum:
    - npm
    - yarn
    - pnpm
    - go
    - pip
    - poetry
    - maven
    - gradle
    - cargo
    - unknown
    type: string
    x-enum-varnames:
    - BuildToolNPM
    - BuildToolYarn
    - BuildToolPNPM
    - BuildToolGo
    - BuildToolPip
    - BuildToolPoetry
    - BuildToolMaven
    - BuildToolGradle
    - BuildToolCargo
    - BuildToolUnknown
  analyzer.Framework:
    enum:
    - gin
    - echo
    - chi
    - fiber
    - express
    - nestjs
    - nextjs
    - koa
    - fastify
    - flask
    - django
    - fastapi
    - springboot
    - quarkus
    - unknown
    type: string
    x-enum-varnames:
    - FrameworkGin
    - FrameworkEcho
    - FrameworkChi
    - FrameworkFiber
    - FrameworkExpress
    - FrameworkNestJS
    - FrameworkNextJS
    - FrameworkKoa
    - FrameworkFastify
    - FrameworkFlask
    - FrameworkDjango
    - FrameworkFastAPI
    - FrameworkSpringBoot
    - FrameworkQuarkus
    - FrameworkUnknown
  analyzer.Language:
    enum:
    - go
    - nodejs
    - python
    - java
    - rust
    - ruby
    - php
    - dotnet
    - unknown
    type: string
    x-enum-varnames:
    - LanguageGo
    - LanguageNodeJS
    - LanguagePython
    - LanguageJava
    - LanguageRust
    - LanguageRuby
    - LanguagePHP
    - LanguageDotNet
    - LanguageUnknown
  api.AnalyzeRequest:
    properties:
      path:
        type: string
    type: object
  api.BuildImageRequest:
    properties:
      app_name:
        type: string
      deployment_id:
        type: string
      source_path:
        type: string
      version:
        type: string
    type: object
  api.BuildImageResponse:
    properties:
      build_id:
        type: string
      build_log:
        type: string
      error_message:
        type: string
      image_digest:
        type: string
      image_tag:
        type: string
      status:
        type: string
    type: object
  api.BuildResponse:
    properties:
      build_log:
        type: string
      completed_at:
        type: string
      created_at:
        type: string
      deployment_id:
        type: string
      id:
        type: string
      image_tag:
        type: string
      started_at:
        type: string
      status:
        type: string
      updated_at:
        type: string
    type: object
  api.CreateDeploymentRequest:
    properties:
      app_name:
        type: string
      cloud:
        type: string
      image_tag:
        description: 'Optional: if provided, triggers immediate provisioning'
        type: string
      name:
        type: string
      port:
        description: 'Optional: defaults to 8080'
        type: integer
      region:
        type: string
      version:
        type: string
    type: object
  api.DeploymentLogResponse:
    properties:
      details:
        type: string
      id:
        type: string
      job_id:
        type: string
      level:
        type: string
      message:
        type: string
      phase:
        type: string
      timestamp:
        type: string
    type: object
  api.DeploymentResponse:
    properties:
      app_name:
        type: string
      cloud:
        type: string
      created_at:
        type: string
      deployed_at:
        type: string
      external_ip:
        type: string
      external_url:
        type: string
      id:
        type: string
      name:
        type: string
      region:
        type: string
      status:
        type: string
      updated_at:
        type: string
      version:
        type: string
    type: object
  api.ErrorResponse:
    properties:
      error:
        type: string
      message:
        type: string
    type: object
  api.GenerateDockerfileRequest:
    properties:
      source_path:
        type: string
    type: object
  api.GenerateDockerfileResponse:
    properties:
      analysis:
        $ref: '#/definitions/analyzer.AnalysisResult'
      dockerfile:
        type: string
      framework:
        type: string
      language:
        type: string
    type: object
  api.InfrastructureResponse:
    properties:
      cluster_name:
        type: string
      config:
        type: string
      created_at:
        type: string
      deployment_id:
        type: string
      id:
        type: string
      namespace:
        type: string
      service_name:
        type: string
      status:
        type: string
      updated_at:
        type: string
    type: object
  api.ListDeploymentLogsResponse:
    properties:
      limit:
        type: integer
      logs:
        items:
          $ref: '#/definitions/api.DeploymentLogResponse'
        type: array
      offset:
        type: integer
      total:
        type: integer
    type: object
  api.ListDeploymentsResponse:
    properties:
      deployments:
        items:
          $ref: '#/definitions/api.DeploymentResponse'
        type: array
      limit:
        type: integer
      offset:
        type: integer
      total:
        type: integer
    type: object
  api.OrchestrationResponse:
    properties:
      deployment_id:
        type: string
      message:
        type: string
      status:
        type: string
    type: object
  api.QueueStatsResponse:
    properties:
      deploy:
        type: integer
      destroy:
        type: integer
      provision:
        type: integer
      rollback:
        type: integer
    type: object
  api.StartDeploymentRequest:
    properties:
      image_tag:
        description: 'Required: container image to deploy'
        type: string
      port:
        description: 'Optional: defaults to 8080'
        type: integer
      replicas:
        description: 'Optional: defaults to 2'
        type: integer
    type: object
  api.SuccessResponse:
    properties:
      data: {}
      message:
        type: string
    type: object
  api.TriggerRollbackRequest:
    properties:
      target_tag:
        description: 'Optional: specific image tag'
        type: string
      target_version:
        description: 'Required: version to rollback to'
        type: string
    type: object
  api.UpdateDeploymentStatusRequest:
    properties:
      status:
        type: string
    type: object
host: localhost:3000
info:
  contact:
    name: API Support
    url: https://github.com/alvesdmateus/app-deployer
  description: |-
    A custom PaaS platform for automated application deployment.
    Deploy applications from Git repositories to Kubernetes with zero-configuration.
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  title: App Deployer API
  version: "1.0"
paths:
  /analyze:
    post:
      consumes:
      - application/json
      description: Analyze source code at a given path to detect language, framework,
        and dependencies
      parameters:
      - description: Path to analyze
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.AnalyzeRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/analyzer.AnalysisResult'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Analyze source code
      tags:
      - analyzer
  /analyze/languages:
    get:
      description: Returns a list of supported programming languages and their frameworks
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties: true
            type: object
      summary: Get supported languages
      tags:
      - analyzer
  /analyze/upload:
    post:
      consumes:
      - multipart/form-data
      description: Upload source code as a file and analyze it to detect language,
        framework, and dependencies
      parameters:
      - description: Source code archive (zip, tar.gz)
        in: formData
        name: source
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/analyzer.AnalysisResult'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Upload and analyze source code
      tags:
      - analyzer
  /builds:
    post:
      consumes:
      - application/json
      description: Build a container image from source code
      parameters:
      - description: Build request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.BuildImageRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/api.BuildImageResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Build container image
      tags:
      - builder
  /builds/{buildID}/cancel:
    post:
      description: Cancel an in-progress build
      parameters:
      - description: Build ID
        in: path
        name: buildID
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Cancel build
      tags:
      - builder
  /builds/{buildID}/logs:
    get:
      description: Stream the logs for a specific build
      parameters:
      - description: Build ID
        in: path
        name: buildID
        required: true
        type: string
      produces:
      - text/plain
      responses:
        "200":
          description: Build logs
          schema:
            type: string
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get build logs
      tags:
      - builder
  /builds/generate-dockerfile:
    post:
      consumes:
      - application/json
      description: Analyze source code and generate an optimized Dockerfile
      parameters:
      - description: Source path
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.GenerateDockerfileRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.GenerateDockerfileResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Generate Dockerfile
      tags:
      - builder
  /deployments:
    get:
      consumes:
      - application/json
      description: Retrieve a paginated list of all deployments
      parameters:
      - description: 'Maximum number of results (default: 20)'
        in: query
        name: limit
        type: integer
      - description: 'Number of results to skip (default: 0)'
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.ListDeploymentsResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: List all deployments
      tags:
      - deployments
    post:
      consumes:
      - application/json
      description: Create a new deployment configuration. Optionally triggers immediate
        provisioning if image_tag is provided.
      parameters:
      - description: Deployment configuration
        in: body
        name: deployment
        required: true
        schema:
          $ref: '#/definitions/api.CreateDeploymentRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/api.DeploymentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Create a new deployment
      tags:
      - deployments
  /deployments/{deployment_id}/builds/latest:
    get:
      description: Returns the latest build for a specific deployment
      parameters:
      - description: Deployment ID
        in: path
        name: deployment_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.BuildResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get latest build
      tags:
      - builds
  /deployments/{deployment_id}/infrastructure:
    get:
      description: Returns the infrastructure details for a specific deployment
      parameters:
      - description: Deployment ID
        in: path
        name: deployment_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.InfrastructureResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get infrastructure details
      tags:
      - infrastructure
  /deployments/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a deployment and its associated infrastructure. If infrastructure
        exists, triggers async destruction.
      parameters:
      - description: Deployment ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Deployment deleted (no infrastructure)
          schema:
            $ref: '#/definitions/api.SuccessResponse'
        "202":
          description: Destruction initiated (has infrastructure)
          schema:
            $ref: '#/definitions/api.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Delete a deployment
      tags:
      - deployments
    get:
      consumes:
      - application/json
      description: Retrieve detailed information about a specific deployment
      parameters:
      - description: Deployment ID (UUID)
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.DeploymentResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get a deployment by ID
      tags:
      - deployments
  /deployments/{id}/deploy:
    post:
      consumes:
      - application/json
      description: Trigger infrastructure provisioning and application deployment
        with a built container image
      parameters:
      - description: Deployment ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Deployment configuration
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.StartDeploymentRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/api.OrchestrationResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "503":
          description: Orchestration service unavailable
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Start deployment
      tags:
      - deployments
  /deployments/{id}/logs:
    get:
      consumes:
      - application/json
      description: Retrieve logs for a specific deployment, optionally filtered by
        phase
      parameters:
      - description: Deployment ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Filter by phase (BUILDING, PROVISIONING, DEPLOYING, etc.)
        in: query
        name: phase
        type: string
      - description: 'Maximum number of results (default: 100, max: 1000)'
        in: query
        name: limit
        type: integer
      - description: 'Number of results to skip (default: 0)'
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.ListDeploymentLogsResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get deployment logs
      tags:
      - deployments
  /deployments/{id}/rollback:
    post:
      consumes:
      - application/json
      description: Rollback a deployment to a previous version
      parameters:
      - description: Deployment ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: Rollback configuration
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/api.TriggerRollbackRequest'
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/api.OrchestrationResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "503":
          description: Orchestration service unavailable
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Trigger rollback
      tags:
      - deployments
  /deployments/{id}/status:
    patch:
      consumes:
      - application/json
      description: Manually update the status of a deployment
      parameters:
      - description: Deployment ID (UUID)
        in: path
        name: id
        required: true
        type: string
      - description: New status
        in: body
        name: status
        required: true
        schema:
          $ref: '#/definitions/api.UpdateDeploymentStatusRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.SuccessResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Update deployment status
      tags:
      - deployments
  /deployments/status/{status}:
    get:
      consumes:
      - application/json
      description: Retrieve all deployments with a specific status
      parameters:
      - description: Deployment status (PENDING, QUEUED, BUILDING, PROVISIONING, DEPLOYING,
          HEALTHY, FAILED, etc.)
        in: path
        name: status
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/api.DeploymentResponse'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get deployments by status
      tags:
      - deployments
  /orchestrator/stats:
    get:
      consumes:
      - application/json
      description: Retrieve statistics about the job queues (provision, deploy, destroy,
        rollback)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/api.QueueStatsResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/api.ErrorResponse'
        "503":
          description: Orchestration service unavailable
          schema:
            $ref: '#/definitions/api.ErrorResponse'
      summary: Get queue statistics
      tags:
      - orchestrator
securityDefinitions:
  ApiKeyAuth:
    in: header
    name: X-API-Key
    type: apiKey
swagger: "2.0"
